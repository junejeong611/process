"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[793],{3793:(e,s,a)=>{a.r(s),a.d(s,{default:()=>x});var r=a(5043),t=a(108),i=a(163),n=a(4240),o=a(7869),l=a(6150),c=a(6931),d=a(579);const m=()=>localStorage.getItem("token")||sessionStorage.getItem("token"),h={anger:"#ef4444",sadness:"#3b82f6",fear:"#f97316",shame:"#a855f7",disgust:"#10b981"},u=()=>{const[e,s]=(0,r.useState)("week"),a=(0,r.useMemo)((()=>(()=>{try{const e=m();return e&&JSON.parse(atob(e.split(".")[1])).userId||null}catch(e){return console.error("Error extracting userId from token:",e),null}})()),[]),{data:u,isLoading:x,error:g}=(0,c.I)({queryKey:["emotion-distribution",e,a],queryFn:async()=>{const s=m(),r=await fetch(`/api/insights/${a}/emotional-distribution?period=${e}`,{headers:{Authorization:`Bearer ${s}`}}),t=await r.json();if(!t.success)throw new Error("Failed to load emotional distribution data");return t.data},staleTime:3e5,cacheTime:18e5,retry:2});return x?(0,d.jsx)("div",{className:"chart-loading",children:"Loading emotional distribution..."}):g?(0,d.jsx)("div",{className:"error-card error-card--warning",children:(0,d.jsxs)("div",{className:"error-card__content",children:[(0,d.jsx)("div",{className:"error-card__icon",children:"\ud83d\udcca"}),(0,d.jsx)("div",{className:"error-card__text",children:(0,d.jsx)("p",{className:"error-card__message",children:g.message})})]})}):null===u||void 0===u||!u.length||u.every((e=>0===e.value))?(0,d.jsx)("div",{className:"empty-emotion-distribution",children:(0,d.jsxs)("div",{className:"empty-state-message",style:{textAlign:"center"},children:[(0,d.jsx)("h4",{children:"No emotional distribution data yet"}),(0,d.jsx)("p",{children:"Share more about how you're feeling to see your emotional breakdown."})]})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"section-header-simple",children:[(0,d.jsx)("h3",{children:"Emotional Distribution"}),(0,d.jsx)("p",{children:"breakdown of your emotional states"})]}),(0,d.jsx)("div",{className:"pie-chart-container",children:(0,d.jsx)(t.u,{width:"100%",height:400,aspect:2,children:(0,d.jsxs)(i.r,{margin:{top:20,right:20,bottom:20,left:20},children:[(0,d.jsx)(n.F,{data:u,cx:"50%",cy:"50%",innerRadius:80,outerRadius:160,dataKey:"value",nameKey:"emotion",label:e=>{let{name:s,percent:a}=e;return`${s} ${(100*a).toFixed(0)}%`},labelLine:!1,children:u.map(((e,s)=>(0,d.jsx)(o.f,{fill:h[e.emotion]||"#8884d8"},`cell-${s}`)))}),(0,d.jsx)(l.m,{formatter:e=>`${e}%`})]})})}),(0,d.jsx)("div",{className:"emotion-legend-small",children:u.map((e=>(0,d.jsxs)("div",{className:"emotion-legend-item-small",children:[(0,d.jsx)("div",{className:"legend-color-small",style:{backgroundColor:h[e.emotion]}}),(0,d.jsx)("span",{className:"legend-label-small",children:e.emotion})]},e.emotion)))}),(0,d.jsxs)("div",{className:"period-selector",style:{marginTop:"1rem"},children:[(0,d.jsx)("button",{onClick:()=>s("week"),className:"week"===e?"active":"",children:"this week"}),(0,d.jsx)("button",{onClick:()=>s("month"),className:"month"===e?"active":"",children:"this month"})]})]})},x=r.memo(u)}}]);
//# sourceMappingURL=793.f72bbe8b.chunk.js.map